<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rainfall Patterns in Australia</title>

  <!-- Vega libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <style>
    /* headings */
    h1, p.header-sub { text-align:center; margin: 0.25rem 0 1rem; }

    :root {
      --trend-title-offset: 36px;
      --toploc-title-offset: 36px;
      --map-title-offset: 36px;
      --scatter-title-offset: 36px;
      --season-title-offset: 36px;
    }

    /* ===== trend ===== */
    .trend-row{ display:flex; gap:16px; align-items:flex-start; }
    .trend-chart{ flex:1 1 auto; min-width:640px; min-height:320px; }
    .trend-notes{
      flex:0 0 360px; align-self:flex-start;
      margin-top: var(--trend-title-offset);
      border:1px solid #e5e7eb; border-radius:8px;
      padding:10px 12px; background:#fff; line-height:1.35;
    }

    /* ===== top 10 ===== */
    .toploc-row{ display:flex; gap:16px; align-items:flex-start; }
    .toploc-chart{ flex:1 1 auto; min-width:640px; min-height:420px; }
    .toploc-notes{
      flex:0 0 360px; align-self:flex-start;
      margin-top: var(--toploc-title-offset);
      border:1px solid #e5e7eb; border-radius:8px;
      padding:10px 12px; background:#fff; line-height:1.35;
    }

    /* ===== map ===== */
    .map-row{ display:flex; gap:16px; align-items:flex-start; }
    .map-chart{ flex:1 1 auto; min-width:640px; min-height:520px; }
    .map-notes{
      flex:0 0 360px; align-self:flex-start;
      margin-top: var(--map-title-offset);
      border:1px solid #e5e7eb; border-radius:8px;
      padding:10px 12px; background:#fff; line-height:1.35;
    }

    /* ===== rainfall vs temp ===== */
    .scatter-row{ display:flex; gap:16px; align-items:flex-start; }
    .scatter-chart{ flex:1 1 auto; min-width:640px; min-height:420px; }
    .scatter-notes{
      flex:0 0 360px; align-self:flex-start;
      margin-top: var(--scatter-title-offset);
      border:1px solid #e5e7eb; border-radius:8px;
      padding:10px 12px; background:#fff; line-height:1.35;
    }

    /* ===== seasonality ===== */
    .season-row{ display:flex; gap:16px; align-items:flex-start; }
    .season-chart{ flex:1 1 auto; min-width:640px; min-height:320px; }
    .season-notes{
      flex:0 0 360px; align-self:flex-start;
      margin-top: var(--season-title-offset);
      border:1px solid #e5e7eb; border-radius:8px;
      padding:10px 12px; background:#fff; line-height:1.35;
    }

    /* Stack on small screens */
    @media (max-width: 900px){
      .trend-row, .toploc-row, .map-row, .scatter-row, .season-row{ flex-direction:column; }
      .trend-chart, .toploc-chart, .map-chart, .scatter-chart, .season-chart{ min-width:0; }
      .trend-notes, .toploc-notes, .map-notes, .scatter-notes, .season-notes{ margin-top:8px; }
    }
  </style>
</head>
<body>
  <h1>Rainfall Patterns in Australia</h1>
  <p class="header-sub"><strong>Melanie Paaris 33116121</strong></p>

  <!-- ===== National Annual Rainfall ===== -->
  <h2>National Annual Rainfall</h2>
  <section class="trend-row">
    <div id="trend" class="trend-chart"></div>
    <aside class="trend-notes">
      <ul style="margin:0; padding-left:1rem;">
        <li><strong>Wettest period:</strong> 2010–2011 sits clearly above the mean, indicating an unusually wet couple of years.</li>
        <li><strong>Driest year:</strong> 2014 falls well below the mean, marking the decade’s low point.</li>
        <li><strong>Overall pattern:</strong> No strong long-term trend, rise to 2011, decrease to 2014, then steady recovery; most years near the mean.</li>
      </ul>
    </aside>
  </section>

  <!-- ===== Top 10 Locations (by year) ===== -->
  <h2>Top 10 Locations (by year)</h2>
  <section class="toploc-row">
    <div id="toploc" class="toploc-chart"></div>
    <aside class="toploc-notes">
      <ul style="margin:0; padding-left:1rem;">
        <li><strong>Cairns & Coffs Harbour lead often;</strong> Darwin surges to #1 in 2017 with the decade’s peak.</li>
        <li><strong>Tropical/east-coast hubs dominate</strong> (Cairns, Darwin, Townsville, Coffs Harbour, Gold Coast, Sydney/Wollongong/Newcastle); inland/southern sites are rare.</li>
        <li><strong>Year-to-year swings:</strong> strong around 2010–11, softer 2014–16, then a sharp rebound in 2017.</li>
      </ul>
    </aside>
  </section>

  <!-- ===== Rainfall by State (Choropleth) ===== -->
  <h2>Rainfall by State (Choropleth)</h2>
  <section class="map-row">
    <div id="map" class="map-chart"></div>
    <aside class="map-notes">
      <ul style="margin:0; padding-left:1rem;">
        <li><strong>Top-end stays wettest:</strong> Northern Territory and Queensland dominate state averages most years, with standout peaks in QLD ~5.74&nbsp;mm (2010) and NT ~5.70&nbsp;mm (2017).</li>
        <li><strong>South/temperate states are driest:</strong> SA, TAS, VIC and ACT mostly sit around ~1–2&nbsp;mm; lows include SA ~0.98&nbsp;mm (2015) and ACT ~1.05&nbsp;mm (2017).</li>
        <li><strong>Clear year-to-year swings:</strong> Broad spike 2010–11 (especially QLD/NT), a trough around 2014–15, then a rebound by 2016–17.</li>
      </ul>
    </aside>
  </section>

  <!-- ===== Rainfall vs Temperature ===== -->
  <h2>Rainfall vs Temperature</h2>
  <section class="scatter-row">
    <div id="rainTemp" class="scatter-chart"></div>
    <aside class="scatter-notes">
      <ul style="margin:0; padding-left:1rem;">
        <li><strong>Cooler months tend to be wetter:</strong> regression line slopes down, indicating higher rainfall at lower average max temps.</li>
        <li><strong>Seasonality:</strong> points cluster into cooler-wetter vs hotter-drier months, complementing the yearly trend.</li>
        <li><strong>Outliers:</strong> very wet, warm tropical months sit above the trend, highlighting the monsoonal north’s influence.</li>
      </ul>
    </aside>
  </section>

 <h2>Monthly Seasonality</h2>
<section class="season-row">
  <div id="seasonality" class="season-chart"></div>
  <aside class="season-notes">
    <ul style="margin:0; padding-left:1rem;">
      <li><strong>Wettest months (Dec–Mar):</strong> These summer months show the highest average rainfall, reflecting Australia’s <em>northern wet season</em> influenced by tropical monsoons.</li>
      <li><strong>Driest period (Jun–Oct):</strong> Mid to late year experiences the lowest rainfall, representing the <em>national dry season</em>, especially in central and northern regions.</li>
      <li><strong>Clear seasonal pattern:</strong> The smooth rise and fall of the curve reveal a predictable annual rainfall cycle, with strong contrasts between wet and dry periods across the country.</li>
    </ul>
    <p style="margin:10px 0 0;">
      <strong>Summary:</strong> Australia’s national rainfall seasonality reflects <em>two overlapping systems</em> ; tropical summer monsoons in the north and winter westerly rain in the south ; producing peaks in early summer and mid-year, with a pronounced dry period around September–October.
    </p>
  </aside>
</section>

  <!-- ================= Vega-Lite SPECS ================= -->

  <!-- Trend -->
  <script type="application/json" id="spec-trend">{
    "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
    "width":900,"height":320,
    "title":{"text":"Average Annual Rainfall — Australia (2008–2017)","anchor":"start","offset":6},
    "data":{"url":"rainfall_timeseries.csv"},
    "transform":[{"filter":"datum.Year >= 2008 && datum.Year <= 2017"}],
    "layer":[
      {"transform":[{"aggregate":[{"op":"mean","field":"rain_mm","as":"mean_mm"}]}],
       "mark":{"type":"rule","strokeDash":[6,4],"color":"#888"},
       "encoding":{"y":{"field":"mean_mm","type":"quantitative","title":"Rainfall (mm)"}}},
      {"mark":{"type":"line","point":true},
       "encoding":{"x":{"field":"Year","type":"quantitative","title":"Year","axis":{"format":"d","tickMinStep":1}},
                   "y":{"field":"rain_mm","type":"quantitative","title":"Rainfall (mm)"},
                   "tooltip":[{"field":"Year","type":"quantitative"},
                              {"field":"rain_mm","type":"quantitative","format":".2f","title":"Avg (mm)"}]}}
    ]}</script>

  <!-- Top locations -->
  <script type="application/json" id="spec-toploc">
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 420,
  "title": "Top 10 Locations by Average Rainfall",
  "params": [
    {
      "name": "year_sel",
      "value": 2017,
      "bind": { "name": "Year: ", "input": "range", "min": 2008, "max": 2017, "step": 1 }
    }
  ],
  "data": { "url": "rainfall_by_location.csv" },
  "transform": [
    { "calculate": "toNumber(datum.Year)", "as": "YearNum" },
    { "filter": "datum.YearNum == year_sel" },
    { "window": [ { "op": "rank", "as": "rank" } ], "sort": [ { "field": "rain_mm", "order": "descending" } ] },
    { "filter": "datum.rank <= 10" }
  ],
  "mark": "bar",
  "encoding": {
    "y": { "field": "Location", "type": "nominal", "sort": "-x", "title": null },
    "x": {
      "field": "rain_mm",
      "type": "quantitative",
      "title": "Avg rainfall (mm)",
      "scale": { "domain": [0, 10], "nice": false, "clamp": true },
      "axis": { "values": [0,1,2,3,4,5,6,7,8,9,10], "tickCount": 11 }
    },
    "color": {
      "field": "Location",
      "type": "nominal",
      "legend": { "title": "Location" },
      "scale": {
        "domain": [
          "Cairns","CoffsHarbour","Darwin","Townsville","GoldCoast",
          "MountGambier","Tuggeranong","Wollongong","Brisbane","MountGinini",
          "Sydney","Katherine","NorahHead","Newcastle","Williamtown",
          "Walpole","Witchcliffe","NorfolkIsland","SydneyAirport"
        ],
        "scheme": "tableau20"
      }
    },
    "tooltip": [
      { "field": "Location", "type": "nominal" },
      { "field": "rain_mm", "type": "quantitative", "format": ".1f", "title": "Avg (mm)" }
    ]
  }
}
</script>

  <!-- Map -->
  <script type="application/json" id="spec-map">{
    "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
    "width":900,"height":500,
    "title":{"text":{"expr":"'Rainfall by State — ' + mapYear"},"anchor":"start"},
    "projection":{"type":"mercator"},
    "params":[{"name":"mapYear","value":2017,"bind":{"name":"Year: ","input":"range","min":2008,"max":2017,"step":1}}],
    "data":{"url":"AUS_states.json","format":{"type":"topojson","feature":"AUS_states"}},
    "transform":[
      {"calculate":"({'New South Wales':'NSW','Northern Territory':'NT','Queensland':'QLD','South Australia':'SA','Tasmania':'TAS','Victoria':'VIC','Western Australia':'WA','Australian Capital Territory':'ACT'})[(datum.properties && (datum.properties.STATE_NAME ? datum.properties.STATE_NAME : (datum.properties.name ? datum.properties.name : datum.properties.STE_NAME21)))]","as":"abbr"},
      {"lookup":"abbr",
       "from":{"data":{"url":"rainfall_by_state.csv"},
               "transform":[{"calculate":"toNumber(datum.Year)","as":"Y"},{"filter":"datum.Y == mapYear"}],
               "key":"State","fields":["rain_mm"]}}
    ],
    "mark":{"type":"geoshape","stroke":"white"},
    "encoding":{
      "color":{"field":"rain_mm","type":"quantitative","title":"Avg rainfall (mm)","scale":{"scheme":"blues"}},
      "tooltip":[{"field":"properties.STATE_NAME","type":"nominal","title":"State"},
                 {"field":"abbr","type":"nominal","title":"Code"},
                 {"field":"rain_mm","type":"quantitative","format":".2f","title":"Avg (mm)"}]
    }}</script>

  <!-- Rainfall vs Temperature -->
<script type="application/json" id="spec-rainTemp">
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 900,
  "height": 420,
  "title": "Monthly Average Rainfall vs Temperature — Australia (2008–2017)",
  "data": {
    "url": "weatherAUS.csv",
    "format": {
      "type": "csv",
      "parse": { "Date": "date", "Rainfall": "number", "MaxTemp": "number" }
    }
  },
  "transform": [
    { "filter": "isValid(datum.Rainfall) && isFinite(datum.Rainfall) && isValid(datum.MaxTemp) && isFinite(datum.MaxTemp)" },

    { "timeUnit": "yearmonth", "field": "Date", "as": "YM" },
    { "timeUnit": "year",       "field": "Date", "as": "Year" },

    {
      "aggregate": [
        { "op": "mean", "field": "Rainfall", "as": "r_mm" },
        { "op": "mean", "field": "MaxTemp",  "as": "t_c" }
      ],
      "groupby": ["YM","Year"]
    },

    { "filter": "year(datum.YM) >= 2008 && year(datum.YM) <= 2017" },

    { "filter": "isFinite(datum.r_mm) && isFinite(datum.t_c)" }
  ],

  "layer": [
    {
      "mark": { "type": "point", "filled": true, "opacity": 0.6, "size": 60 },
      "encoding": {
        "x": { "field": "t_c", "type": "quantitative", "title": "Avg temperature (°C)" },
        "y": { "field": "r_mm", "type": "quantitative", "title": "Avg rainfall (mm)" },
        "color": {
          "field": "Year", "type": "ordinal",
          "legend": {"title": "Year"}, "scale": {"scheme": "plasma"}
        },
        "tooltip": [
          { "field": "Year", "type": "quantitative" },
          { "field": "t_c",  "type": "quantitative", "format": ".1f", "title": "Temp (°C)" },
          { "field": "r_mm", "type": "quantitative", "format": ".2f", "title": "Rain (mm)" }
        ]
      }
    },
    {
      "transform": [ { "regression": "r_mm", "on": "t_c" } ],
      "mark": { "type": "line", "strokeDash": [6,4] }
    }
  ]
}
</script>


  <!-- Seasonality -->
  <script type="application/json" id="spec-seasonality">{
    "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
    "width":900,"height":320,
    "title":"Average Monthly Rainfall — Australia (2008–2017)",
    "data":{"url":"weatherAUS.csv","format":{"type":"csv","parse":{"Date":"date","Rainfall":"number"}}},
    "transform":[
      {"filter":"isValid(datum.Rainfall) && isFinite(+datum.Rainfall)"},
      {"calculate":"year(datum.Date)","as":"Y"},
      {"filter":"datum.Y >= 2008 && datum.Y <= 2017"}
    ],
    "encoding":{
      "x":{"timeUnit":"month","field":"Date","title":null,"axis":{"format":"%b"}},
      "y":{"aggregate":"mean","field":"Rainfall","title":"Avg rainfall (mm)"},
      "tooltip":[{"timeUnit":"month","field":"Date","title":"Month","format":"%b"},
                 {"aggregate":"mean","field":"Rainfall","title":"Avg (mm)","format":".2f"}]
    },
    "layer":[
      {"mark":{"type":"area","opacity":0.15}},
      {"mark":{"type":"line"}},
      {"mark":{"type":"point"}}
    ]}</script>

  <!-- ============ Embed helper ============ -->
  <script>
    function embedFromTag(target, tagId) {
      const spec = JSON.parse(document.getElementById(tagId).textContent);
      return vegaEmbed(target, spec, { actions: false });
    }
    embedFromTag('#trend', 'spec-trend');
    embedFromTag('#toploc', 'spec-toploc');
    embedFromTag('#map', 'spec-map');
    embedFromTag('#rainTemp', 'spec-rainTemp');
    embedFromTag('#seasonality', 'spec-seasonality');
  </script>
</body>
</html>





